---
layout: page
# All the Categories of posts
---

{% include lang.html %}

{% assign HEAD_PREFIX = 'h_' %}
{% assign LIST_PREFIX = 'l_' %}

{% assign group_index = 0 %}

<!-- 안전한 트리 생성 -->
{% assign all_posts = site.posts %}
{% assign top_categories = "" | split: "" %}
{% assign raw_pairs = "" | split: "" %}

{% for post in all_posts %}
{% assign cat0 = post.categories[0] %}
{% assign cat1 = post.categories[1] %}

{% unless top_categories contains cat0 %}
{% assign top_categories = top_categories | push: cat0 %}
{% endunless %}

{% if cat1 %}
{% assign pair = cat0 | append: '__' | append: cat1 %}
{% unless raw_pairs contains pair %}
{% assign raw_pairs = raw_pairs | push: pair %}
{% endunless %}
{% endif %}
{% endfor %}

<!-- 렌더링 -->
{% for cat0 in top_categories %}
{% assign sub_categories = "" | split: "" %}

{% for pair in raw_pairs %}
{% assign split_pair = pair | split: '__' %}
{% assign parent = split_pair[0] %}
{% assign child = split_pair[1] %}

{% if parent == cat0 %}
{% assign sub_categories = sub_categories | push: child %}
{% endif %}
{% endfor %}

{% assign sub_categories = sub_categories | sort %}
{% assign sub_categories_size = sub_categories | size %}
{% assign top_posts_size = 0 %}
{% for post in site.posts %}
{% if post.categories[0] == cat0 %}
{% assign top_posts_size = top_posts_size | plus: 1 %}
{% endif %}
{% endfor %}


<div class="card categories">
  <div id="{{ HEAD_PREFIX }}{{ group_index }}" class="card-header d-flex justify-content-between hide-border-bottom">
    <span class="ms-2">
      <i class="far fa-folder{% if sub_categories_size > 0 %}-open{% endif %} fa-fw"></i>

      {% capture _category_url %}/categories/{{ cat0 | slugify | url_encode }}/{% endcapture %}
      <a href="{{ _category_url | relative_url }}" class="mx-2">{{ cat0 }}</a>

      <span class="text-muted small font-weight-light">
        {% if sub_categories_size > 0 %}
        {{ sub_categories_size }}
        {% if sub_categories_size > 1 %}
        {{ site.data.locales[lang].categories.category_measure.plural
        | default: site.data.locales[lang].categories.category_measure }}
        {% else %}
        {{ site.data.locales[lang].categories.category_measure.singular
        | default: site.data.locales[lang].categories.category_measure }}
        {% endif %},
        {% endif %}

        {{ top_posts_size }}
        {% if top_posts_size > 1 %}
        {{ site.data.locales[lang].categories.post_measure.plural
        | default: site.data.locales[lang].categories.post_measure }}
        {% else %}
        {{ site.data.locales[lang].categories.post_measure.singular
        | default: site.data.locales[lang].categories.post_measure }}
        {% endif %}
      </span>
    </span>

    {% if sub_categories_size > 0 %}
    <a href="#{{ LIST_PREFIX }}{{ group_index }}" data-bs-toggle="collapse" aria-expanded="true"
      aria-label="{{ HEAD_PREFIX }}{{ group_index }}-trigger" class="category-trigger hide-border-bottom">
      <i class="fas fa-fw fa-angle-down"></i>
    </a>
    {% else %}
    <span data-bs-toggle="collapse" class="category-trigger hide-border-bottom disabled">
      <i class="fas fa-fw fa-angle-right"></i>
    </span>
    {% endif %}
  </div>

  {% if sub_categories_size > 0 %}
  <div id="{{ LIST_PREFIX }}{{ group_index }}" class="collapse show" aria-expanded="true">
    <ul class="list-group">
      {% for sub_cat in sub_categories %}
      <li class="list-group-item">
        <i class="far fa-folder fa-fw"></i>

        {% capture _sub_ctg_url %}/categories/{{ sub_cat | slugify | url_encode }}/{% endcapture %}
        <a href="{{ _sub_ctg_url | relative_url }}" class="mx-2">{{ sub_cat }}</a>

        {% assign posts_size = site.categories[sub_cat] | size %}
        <span class="text-muted small font-weight-light">
          {{ posts_size }}
          {% if posts_size > 1 %}
          {{ site.data.locales[lang].categories.post_measure.plural
          | default: site.data.locales[lang].categories.post_measure }}
          {% else %}
          {{ site.data.locales[lang].categories.post_measure.singular
          | default: site.data.locales[lang].categories.post_measure }}
          {% endif %}
        </span>
      </li>
      {% endfor %}
    </ul>
  </div>
  {% endif %}
</div>

{% assign group_index = group_index | plus: 1 %}
{% endfor %}